const{Command:Command}=require("commands"),permissions=require("permissions"),{log:log}=require("api"),messageParser=require("message-parser"),{performAllPlayers:performAllPlayers}=require("players");exports.tellraw=((e,r,s)=>{if(new permissions.Permission("mcjs.command.tellraw").hasPermission(r.username))try{const s=JSON.parse(e.join(" "));if(!s.text&&"string"!=typeof s)throw{message:"No valid text object!"};performAllPlayers(s=>{r.sendMessage(e.join(" "),s)}),log("chat",messageParser(s))}catch(e){r.sendMessage([{text:"Malformed JSON! Error:\n",color:"red"},{text:e.message,color:"white"}])}else permissions.defaultError(r._client)}),exports.init=(()=>{new Command({command:"tellraw",filename:"tellraw.mcjsp",info:'Sends a custom JSON encoded message to the server which will be returned to chat. Example: {"text":"Hello, world!","color":"red","bold":"true}',usage:"/tellraw <JSON>"})});